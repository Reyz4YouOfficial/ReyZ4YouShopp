<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIBRARY_CORE | PREMIUM DASHBOARD</title>
    <style>
        :root {
            --neon-blue: #00f2ff;
            --neon-yellow: #ffcc00;
            --bg-dark: #050505;
            --card-bg: #0d0d0d;
        }

        body {
            background-color: var(--bg-dark);
            color: white;
            font-family: 'Segoe UI', Roboto, sans-serif;
            margin: 0; padding: 0;
        }

        /* --- Hamburger & Sidebar --- */
        .menu-btn {
            position: fixed; top: 20px; left: 20px; z-index: 1000;
            cursor: pointer; background: rgba(0,0,0,0.7);
            padding: 12px; border: 1px solid var(--neon-blue); border-radius: 10px;
        }
        .menu-btn span { display: block; width: 22px; height: 2px; background: var(--neon-blue); margin: 5px 0; }

        .sidebar {
            height: 100%; width: 0; position: fixed; z-index: 999;
            top: 0; left: 0; background: #080808; overflow-x: hidden;
            transition: 0.5s; border-right: 1px solid var(--neon-blue); padding-top: 80px;
        }
        .user-box { text-align: center; padding: 20px; border-bottom: 1px solid #1a1a1a; margin-bottom: 20px; }
        .user-box img { width: 80px; height: 80px; border-radius: 50%; border: 2px solid var(--neon-blue); object-fit: cover; }
        .sidebar a { padding: 15px 30px; text-decoration: none; color: #666; display: block; font-size: 14px; transition: 0.3s; letter-spacing: 1px; }
        .sidebar a:hover { color: var(--neon-blue); background: rgba(0,242,255,0.05); }

        /* --- Banner --- */
        .banner {
            position: relative; width: 100%; height: 220px;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden; border-bottom: 2px solid var(--neon-blue);
        }
        .banner video { position: absolute; width: 100%; height: 100%; object-fit: cover; opacity: 0.4; }
        .banner-content { position: relative; z-index: 2; text-align: center; }
        .banner-content h1 { color: var(--neon-yellow); letter-spacing: 8px; margin: 0; font-size: 26px; }

        /* --- Tabs --- */
        .nav-tabs { display: flex; background: #000; padding: 10px; gap: 10px; position: sticky; top: 0; z-index: 10; border-bottom: 1px solid #111; overflow-x: auto; }
        .tab-btn { flex: 1; padding: 12px; background: #0d0d0d; border: 1px solid #222; color: #444; border-radius: 8px; font-weight: bold; cursor: pointer; white-space: nowrap; }
        .tab-btn.active { background: rgba(0,242,255,0.1); color: var(--neon-blue); border-color: var(--neon-blue); }

        /* --- Product Cards --- */
        .container { padding: 20px; max-width: 600px; margin: 0 auto; }
        .card {
            background: var(--card-bg); border-radius: 15px; border: 1px solid #1a1a1a;
            padding: 20px; margin-bottom: 15px; display: flex; justify-content: space-between;
            align-items: center; cursor: pointer; transition: 0.3s;
        }
        .card:hover { border-color: var(--neon-blue); transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,242,255,0.1); }
        .card-title { font-weight: bold; font-size: 16px; display: block; }
        .card-desc { font-size: 11px; color: #555; margin-top: 4px; }
        .price { color: var(--neon-blue); font-weight: bold; font-size: 14px; }

        /* --- MODAL CHECKOUT MEWAH --- */
        .modal {
            display: none; position: fixed; z-index: 2000;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); backdrop-filter: blur(10px);
            align-items: center; justify-content: center;
        }
        .checkout-card {
            background: #0d0d0d; width: 90%; max-width: 380px;
            padding: 30px; border-radius: 25px; border: 1px solid var(--neon-blue);
            text-align: center; box-shadow: 0 0 40px rgba(0,242,255,0.2);
            animation: popUp 0.3s ease-out;
        }
        @keyframes popUp { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        
        .checkout-card h3 { color: var(--neon-yellow); margin-bottom: 5px; letter-spacing: 2px; }
        .checkout-card .final-price { font-size: 28px; font-weight: bold; color: var(--neon-blue); margin: 20px 0; display: block; }
        .detail-box { background: #050505; border: 1px dashed #333; padding: 15px; border-radius: 12px; margin-bottom: 25px; text-align: left; font-size: 13px; }

        .btn-confirm { width: 100%; padding: 16px; background: var(--neon-blue); border: none; border-radius: 12px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-confirm:hover { box-shadow: 0 0 20px var(--neon-blue); transform: scale(1.02); }
    </style>
</head>
<body>

    <div class="menu-btn" onclick="toggleNav()">
        <span></span><span></span><span></span>
    </div>

    <div id="sidebar" class="sidebar">
        <div class="user-box">
            <img src="https://via.placeholder.com/80" id="userPhoto">
            <div id="userName" style="margin-top:10px; font-weight:bold;">Operator Node</div>
        </div>
        <a href="/dashboard">DASHBOARD</a>
        <a href="/ai">AI ASISTEN</a>
        <a href="/setting">SETTINGS</a>
        <a href="/" style="color: #ff4444; margin-top: 50px;">LOGOUT</a>
    </div>

    <div class="banner">
        <video autoplay muted loop playsinline><source src="https://g.top4top.io/m_3672d3e6p5.mp4" type="video/mp4"></video>
        <div class="banner-content">
            <h1>LIBRARY_CORE</h1>
            <div style="font-size: 10px; color: var(--neon-blue); letter-spacing: 2px;">SECURE_ACCESS_GRANTED</div>
        </div>
    </div>

    <div class="nav-tabs">
        <button class="tab-btn active" onclick="loadCat('apk', this)">APK_PREMIUM</button>
        <button class="tab-btn" onclick="loadCat('vps', this)">VPS_DO</button>
        <button class="tab-btn" onclick="loadCat('panel', this)">PANEL_PTERO</button>
    </div>

    <div class="container" id="product-list"></div>

    <div id="checkoutModal" class="modal">
        <div class="checkout-card">
            <div style="font-size: 10px; color: #444; margin-bottom: 10px;">INVOICE_GENERATOR_V1</div>
            <h3 id="orderName">PRODUCT NAME</h3>
            <span class="final-price" id="orderPrice">Rp0</span>
            <div class="detail-box">
                <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                    <span>Metode:</span> <span style="color:var(--neon-blue)">QRIS Pakasir</span>
                </div>
                <div style="display:flex; justify-content:space-between;">
                    <span>Status:</span> <span style="color:var(--neon-yellow)">Ready</span>
                </div>
            </div>
            <button class="btn-confirm" onclick="processPayment()">LANJUTKAN PEMBAYARAN</button>
            <button onclick="closeModal()" style="margin-top:15px; background:none; border:none; color:#444; font-size:12px; cursor:pointer;">BATALKAN</button>
        </div>
    </div>

    <script>
        const store = {
            apk: [
                { n: "Netflix Premium", d: "4K UHD | 30 Days", p: "Rp15.000" },
                { n: "Spotify Premium", d: "Family Plan | 1 Month", p: "Rp12.000" }
            ],
            vps: [
                { n: "VPS Digital Ocean", d: "Credit $200 | 60 Days", p: "Rp45.000" }
            ],
            panel: [
                { n: "Panel Pterodactyl", d: "Ram 8GB | Private Node", p: "Rp15.000" }
            ]
        };

        let currentItem = {};

        function toggleNav() {
            const s = document.getElementById("sidebar");
            s.style.width = s.style.width === "260px" ? "0" : "260px";
        }

        function loadCat(cat, btn) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            const list = document.getElementById('product-list');
            list.innerHTML = store[cat].map(p => `
                <div class="card" onclick="openCheckout('${p.n}', '${p.p}')">
                    <div>
                        <span class="card-title">${p.n}</span>
                        <span class="card-desc">${p.d}</span>
                    </div>
                    <div class="price">${p.p}</div>
                </div>
            `).join('');
        }

        function openCheckout(name, price) {
            currentItem = { name, price };
            document.getElementById('orderName').innerText = name;
            document.getElementById('orderPrice').innerText = price;
            document.getElementById('checkoutModal').style.display = 'flex';
        }

        function closeModal() { document.getElementById('checkoutModal').style.display = 'none'; }

        // Ganti fungsi processPayment di dalam <script> dashboard.html kamu:
async function processPayment() {
    const amount = parseInt(currentItem.price.replace(/[^0-9]/g, ''));
    
    try {
        const res = await fetch('/api/pakasir.js', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                amount: amount, 
                itemName: currentItem.name 
            })
        });
        
        const result = await res.json();
        if(result.url) {
            window.location.href = result.url; // Langsung terbang ke Pakasir
        } else {
            alert("Gagal mengambil link pembayaran.");
        }
    } catch (err) {
        alert("Terjadi kesalahan koneksi.");
    }
}

        window.onload = () => loadCat('apk', document.querySelector('.tab-btn'));
    </script>
</body>
</html>
